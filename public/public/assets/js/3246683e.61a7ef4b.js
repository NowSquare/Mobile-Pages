(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["3246683e"],{"055e":function(e,t,a){},"07ab":function(e,t,a){},"37c5":function(e,t,a){"use strict";var i=a("07ab"),n=a.n(i);n.a},"425d":function(e,t,a){"use strict";var i=a("055e"),n=a.n(i);n.a},5212:function(e,t,a){},"523d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"flex"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.$q.screen.gt.sm,expression:"$q.screen.gt.sm"}],staticClass:"col bg-grey-1"},[a("div",{staticClass:"flex fit relative-position"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteLoading,expression:"!siteLoading"}],staticClass:"full-width",staticStyle:{"padding-bottom":"100px"}},[a("q-form",{staticClass:"fit",attrs:{id:"frmSite",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.saveSite(t)}}},[a("q-toolbar",[a("q-toolbar-title",{staticClass:"text-body1 text-center"},[e._v(" "+e._s(e.site.pages[0].name)),e.siteChangesDetected?a("span",[e._v(" *")]):e._e()]),e.siteChangesDetected?a("q-btn",{attrs:{flat:"",round:"",dense:"",type:"submit"}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"save"}}),a("q-tooltip",[e._v("\n                "+e._s(e.$t("save_changes"))+"\n                ")])],1):e._e(),e.siteChangesDetected?a("q-btn",{attrs:{flat:"",round:"",dense:""},on:{click:e.undoSiteChanges}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"undo"}}),a("q-tooltip",[e._v("\n                "+e._s(e.$t("undo_changes"))+"\n                ")])],1):e._e(),a("q-btn",{attrs:{flat:"",round:"",dense:""}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"more_vert"}}),a("q-menu",{attrs:{"transition-show":"jump-down","transition-hide":"jump-up"}},[a("q-list",{staticStyle:{"min-width":"120px"}},[a("q-item",{attrs:{clickable:""}},[a("q-item-section",[e._v("Open site in new window")])],1),a("q-item",{attrs:{clickable:""}},[a("q-item-section",[e._v("Show QR code")])],1),a("q-separator"),a("q-item",{staticClass:"text-red",attrs:{clickable:""}},[a("q-item-section",[e._v("Delete site")])],1)],1)],1)],1)],1),a("q-separator"),a("q-tabs",{staticClass:"text-blue-grey-9 bg-blue-grey-1",attrs:{"active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.siteTab,callback:function(t){e.siteTab=t},expression:"siteTab"}},[a("q-tab",{attrs:{name:"pages",label:"Pages"}}),a("q-tab",{attrs:{name:"add_page",label:"Add Page"}}),a("q-tab",{attrs:{name:"site",label:"Site"}}),a("q-tab",{attrs:{name:"design",label:"Design"}})],1),a("q-separator"),a("div",{staticClass:"fit"},[a("q-scroll-area",{staticClass:"fit"},[a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:e.siteTab,callback:function(t){e.siteTab=t},expression:"siteTab"}},[a("q-tab-panel",{attrs:{name:"pages"}},[a("div",{staticClass:"fit q-pa-xs q-gutter-md row"},[a("q-tree",{staticStyle:{"user-select":"none"},attrs:{nodes:e.site.pages,selected:e.globals.currentPage,"selected-color":"primary","node-key":"uuid","label-key":"name",expanded:e.treeExpandedKeys},on:{"update:selected":[function(t){return e.$set(e.globals,"currentPage",t)},e.checkForPageChanges],"update:expanded":function(t){e.treeExpandedKeys=t}}})],1)]),a("q-tab-panel",{attrs:{name:"add_page"}},[a("div",{staticClass:"fit q-pa-xs q-gutter-lg row"},e._l(e.pageModules,function(t,i){return a("q-btn",{key:i,staticClass:"site-page",attrs:{round:"",flat:"",color:t.color,stack:"","no-caps":"",size:"32px"}},[a("q-icon",{staticClass:"q-mb-xs",attrs:{size:"28px",name:t.icon}}),a("div",{staticClass:"title",staticStyle:{"line-height":"18px"}},[e._v(e._s(t.text))]),a("q-tooltip",[e._v("\n                        "+e._s(t.description)+"\n                        ")])],1)}),1)]),a("q-tab-panel",{attrs:{name:"site"}},[a("q-input",{ref:"siteName",attrs:{label:"Name",name:"siteName",maxlength:"64",error:"undefined"!==typeof e.errorBag.siteName&&e.errorBag.siteName.error,"error-message":"undefined"!==typeof e.errorBag.siteName?e.errorBag.siteName.errorMsg:null},model:{value:e.site.pages[0].name,callback:function(t){e.$set(e.site.pages[0],"name",t)},expression:"site.pages[0].name"}})],1),a("q-tab-panel",{attrs:{name:"design","keep-alive":""}},[a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{staticClass:"text-subtitle1",attrs:{"dense-toggle":"",label:"Site","header-class":"bg-grey-1"},model:{value:e.expandedSiteDesignBackground,callback:function(t){e.expandedSiteDesignBackground=t},expression:"expandedSiteDesignBackground"}},[a("q-separator"),a("div",{staticClass:"q-pa-lg"},[a("ColorPicker",{attrs:{label:"Site background color"},model:{value:e.site.design.bgColor,callback:function(t){e.$set(e.site.design,"bgColor",t)},expression:"site.design.bgColor"}}),a("ColorPicker",{attrs:{label:"Site text color"},model:{value:e.site.design.textColor,callback:function(t){e.$set(e.site.design,"textColor",t)},expression:"site.design.textColor"}}),a("ImageUpload",{key:"imgSiteBg",ref:"imgSiteBg",attrs:{label:"Background image",name:"imgSiteBg",error:"undefined"!==typeof e.errorBag.imgSiteBg&&e.errorBag.imgSiteBg.error,"error-message":"undefined"!==typeof e.errorBag.imgSiteBg?e.errorBag.imgSiteBg.errorMsg:null,"default-value":e.site.design.imgSiteBgFileName},on:{filename:function(t){e.site.design.imgSiteBgFileName=t}},model:{value:e.site.design.imgSiteBg,callback:function(t){e.$set(e.site.design,"imgSiteBg",t)},expression:"site.design.imgSiteBg"}})],1)],1),a("q-separator"),a("q-expansion-item",{staticClass:"text-subtitle1",attrs:{"dense-toggle":"",label:"Header","header-class":"bg-grey-1"},model:{value:e.expandedSiteDesignHeader,callback:function(t){e.expandedSiteDesignHeader=t},expression:"expandedSiteDesignHeader"}},[a("q-separator"),a("div",{staticClass:"q-pa-lg"},[a("ColorPicker",{attrs:{label:"Header background color"},model:{value:e.site.design.headerBgColor,callback:function(t){e.$set(e.site.design,"headerBgColor",t)},expression:"site.design.headerBgColor"}}),a("ColorPicker",{attrs:{label:"Header text color"},model:{value:e.site.design.headerTextColor,callback:function(t){e.$set(e.site.design,"headerTextColor",t)},expression:"site.design.headerTextColor"}})],1)],1),a("q-separator"),a("q-expansion-item",{staticClass:"text-subtitle1",attrs:{"dense-toggle":"",label:"Title toolbar","header-class":"bg-grey-1"},model:{value:e.expandedSiteDesignTitleToolbar,callback:function(t){e.expandedSiteDesignTitleToolbar=t},expression:"expandedSiteDesignTitleToolbar"}},[a("q-separator"),a("div",{staticClass:"q-pa-lg"},[a("ColorPicker",{attrs:{label:"Toolbar background color"},model:{value:e.site.design.titleBarBgColor,callback:function(t){e.$set(e.site.design,"titleBarBgColor",t)},expression:"site.design.titleBarBgColor"}}),a("ColorPicker",{attrs:{label:"Toolbar text color"},model:{value:e.site.design.titleBarTextColor,callback:function(t){e.$set(e.site.design,"titleBarTextColor",t)},expression:"site.design.titleBarTextColor"}})],1)],1),a("q-separator"),a("q-expansion-item",{staticClass:"text-subtitle1",attrs:{"dense-toggle":"",label:"Side navigation","header-class":"bg-grey-1"},model:{value:e.expandedSiteDesignSideNav,callback:function(t){e.expandedSiteDesignSideNav=t},expression:"expandedSiteDesignSideNav"}},[a("q-separator"),a("div",{staticClass:"q-pa-lg"},[a("ColorPicker",{attrs:{label:"Side navigation background color"},model:{value:e.site.design.drawerBgColor,callback:function(t){e.$set(e.site.design,"drawerBgColor",t)},expression:"site.design.drawerBgColor"}}),a("ColorPicker",{attrs:{label:"Side navigation text color"},model:{value:e.site.design.drawerTextColor,callback:function(t){e.$set(e.site.design,"drawerTextColor",t)},expression:"site.design.drawerTextColor"}})],1)],1)],1)],1)],1),a("q-separator")],1)],1)],1)],1),a("q-inner-loading",{attrs:{showing:e.leftColumnLoading}})],1)]),a("q-separator",{attrs:{vertical:""}}),a("div",{staticClass:"col"},[a("div",{staticClass:"flex fit"},[a("div",{staticClass:"full-width relative-position"},[a("SiteView"),a("q-inner-loading",{attrs:{showing:e.siteLoading}})],1)])]),a("q-separator",{attrs:{vertical:""}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.$q.screen.gt.sm,expression:"$q.screen.gt.sm"}],staticClass:"col relative-position bg-grey-1"},[null!==e.globals.currentPage?a("div",{staticClass:"flex fit"},[a("q-form",{staticClass:"fit",staticStyle:{"padding-bottom":"100px"},attrs:{id:"frmPage",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.savePage(t)}}},[a("q-toolbar",[a("q-toolbar-title",{staticClass:"text-body1 text-center"},[e._v(" "+e._s(e.sitePage.name)),e.pageChangesDetected?a("span",[e._v(" *")]):e._e()]),e.pageChangesDetected?a("q-btn",{attrs:{flat:"",round:"",dense:"",type:"submit"}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"save"}}),a("q-tooltip",[e._v("\n              "+e._s(e.$t("save_changes"))+"\n              ")])],1):e._e(),e.pageChangesDetected?a("q-btn",{attrs:{flat:"",round:"",dense:""},on:{click:e.undoPageChanges}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"undo"}}),a("q-tooltip",[e._v("\n              "+e._s(e.$t("undo_changes"))+"\n              ")])],1):e._e(),a("q-btn",{attrs:{flat:"",round:"",dense:""}},[a("q-icon",{staticClass:"text-grey-9",attrs:{name:"more_vert"}}),a("q-menu",{attrs:{"transition-show":"jump-down","transition-hide":"jump-up"}},[a("q-list",{staticStyle:{"min-width":"120px"}},[a("q-item",{staticClass:"text-red",attrs:{clickable:""},on:{click:e.deletePage}},[a("q-item-section",[e._v("Delete page")])],1)],1)],1)],1)],1),a("q-separator"),a("q-tabs",{staticClass:"text-blue-grey-9 bg-blue-grey-1",attrs:{"active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.pageTab,callback:function(t){e.pageTab=t},expression:"pageTab"}},[a("q-tab",{attrs:{name:"content",label:"Content"}}),a("q-tab",{attrs:{name:"settings",label:"Settings"}})],1),a("q-separator"),a("div",{staticClass:"fit"},[a("q-scroll-area",{staticClass:"fit"},[a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:e.pageTab,callback:function(t){e.pageTab=t},expression:"pageTab"}},[a("q-tab-panel",{attrs:{name:"content"}},[a("q-input",{ref:"name",attrs:{label:"Name",name:"name",maxlength:"64",error:"undefined"!==typeof e.errorBag.name&&e.errorBag.name.error,"error-message":"undefined"!==typeof e.errorBag.name?e.errorBag.name.errorMsg:null},model:{value:e.sitePage.name,callback:function(t){e.$set(e.sitePage,"name",t)},expression:"sitePage.name"}}),a("ImageUpload",{key:e.sitePage.uuid,ref:"imgAboveContent",attrs:{label:"Image above content",name:"imgAboveContent",error:"undefined"!==typeof e.errorBag.imgAboveContent&&e.errorBag.imgAboveContent.error,"error-message":"undefined"!==typeof e.errorBag.imgAboveContent?e.errorBag.imgAboveContent.errorMsg:null,"default-value":e.sitePage.content.imgAboveContentFileName},on:{filename:function(t){e.sitePage.content.imgAboveContentFileName=t}},model:{value:e.sitePage.content.imgAboveContent,callback:function(t){e.$set(e.sitePage.content,"imgAboveContent",t)},expression:"sitePage.content.imgAboveContent"}}),a("Editor",{ref:"content",attrs:{label:"Content",name:"content",error:"undefined"!==typeof e.errorBag.content&&e.errorBag.content.error,"error-message":"undefined"!==typeof e.errorBag.content?e.errorBag.content.errorMsg:null},model:{value:e.sitePage.content.content,callback:function(t){e.$set(e.sitePage.content,"content",t)},expression:"sitePage.content.content"}})],1),a("q-tab-panel",{attrs:{name:"settings"}},[a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{staticClass:"text-subtitle1",attrs:{"dense-toggle":"",label:"General","header-class":"bg-grey-1"},model:{value:e.expandedPageSettingsGeneral,callback:function(t){e.expandedPageSettingsGeneral=t},expression:"expandedPageSettingsGeneral"}},[a("q-separator"),a("div",{staticClass:"q-pa-lg"},[e._v("\n\n                        Settings\n\n                      ")])],1)],1),a("q-separator")],1)],1),a("q-separator")],1)],1)],1)],1):e._e(),a("q-inner-loading",{attrs:{showing:e.rightColumnLoading}})],1)],1)},n=[],s=(a("7514"),a("ac4d"),a("8a81"),a("8993")),o=a.n(s),r=(a("ac6a"),a("cadf"),a("456d"),a("551c"),a("06db"),a("097d"),a("6762"),a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-input",{attrs:{label:e.label,rules:["anyColor"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"colorize"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-color",{model:{value:e.selectedColor,callback:function(t){e.selectedColor=t},expression:"selectedColor"}})],1)],1)]},proxy:!0}]),model:{value:e.selectedColor,callback:function(t){e.selectedColor=t},expression:"selectedColor"}},[a("template",{slot:"prepend"},[a("div",{staticStyle:{width:"32px",height:"32px",display:"inline-block",border:"1px solid #c2c2c2","border-radius":"2px"},style:{"background-color":e.selectedColor}})])],2)}),l=[],d={name:"color-picker",model:{prop:"v-model",event:"input"},data:function(){return{inputColor:null}},props:{label:{default:"",required:!1,type:String},vModel:{default:null,required:!1,type:String},color:{default:null,required:!1,type:String}},computed:{selectedColor:{get:function(){return this.vModel},set:function(e){this.$emit("input",e)}}}},c=d,g=a("2877"),u=Object(g["a"])(c,r,l,!1,null,null,null),p=u.exports,m=a("9529"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-field",{attrs:{label:e.label,"stack-label":"",borderless:""},scopedSlots:e._u([{key:"control",fn:function(){return[a("q-editor",{staticClass:"full-width q-mt-sm",attrs:{name:e.name,"min-height":"5rem",toolbar:[[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","link"],[{label:e.$q.lang.editor.fontSize,icon:e.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:e.$q.lang.editor.defaultFont,icon:e.$q.iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["unordered","ordered"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})]},proxy:!0}])})},h=[],b={name:"editor",model:{prop:"v-model",event:"input"},data:function(){return{editorText:null}},props:{label:{default:null,required:!1,type:String},vModel:{default:null,required:!1,type:String},name:{default:null,required:!1,type:String}},computed:{editorContent:{get:function(){return this.vModel},set:function(e){this.editorText=e,this.$emit("input",e)}}}},v=b,C=Object(g["a"])(v,f,h,!1,null,null,null),x=C.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return null!==e.globals.currentPage?a("div",[a("q-layout",{staticClass:"siteBg",style:{height:parseInt(e.$q.screen.height)-58+"px","background-color":e.site.design.bgColor,color:e.site.design.textColor,"background-image":"url("+e.site.design.imgSiteBg+")"},attrs:{view:"lhh LpR lff",container:""}},[a("q-header",{style:{"background-color":e.site.design.headerBgColor,color:e.site.design.headerTextColor},attrs:{reveal:""}},[a("q-toolbar",[a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){e.drawerLeft=!e.drawerLeft}}}),a("q-toolbar-title",[e._v(e._s(e.site.pages[0].name))])],1)],1),a("q-drawer",{attrs:{width:260,breakpoint:700,"content-class":"shadow-1","content-style":{"background-color":e.site.design.drawerBgColor}},model:{value:e.drawerLeft,callback:function(t){e.drawerLeft=t},expression:"drawerLeft"}},[a("q-scroll-area",{staticClass:"fit"},[a("div",{staticClass:"q-pa-sm"},e._l(e.getPages(),function(t){return a("q-item",{key:t.id,style:{color:e.site.design.drawerTextColor},attrs:{clickable:""}},[a("q-item-section",[a("q-item-label",[e._v(e._s(t.name))])],1)],1)}),1)])],1),a("q-page-container",[a("q-page",{staticClass:"q-pa-md",staticStyle:{"padding-top":"66px"}},[a("q-page-sticky",{staticStyle:{"z-index":"999"},style:{"background-color":e.site.design.titleBarBgColor,color:e.site.design.titleBarTextColor},attrs:{position:"top",expand:""}},[a("q-toolbar",[a("q-toolbar-title",[e._v(e._s(e.sitePage.name))])],1)],1),e.sitePage.content.imgAboveContent?a("q-img",{staticClass:"q-mb-md rounded-borders shadow-1",attrs:{src:e.sitePage.content.imgAboveContent,transition:"fade","spinner-color":"white"}}):e._e(),a("div",{domProps:{innerHTML:e._s(e.sitePage.content.content)}})],1)],1)],1)],1):e._e()},q=[],S={name:"MobileSite",data:function(){return{drawerLeft:!1,globals:{currentPage:null},site:{design:{headerBgColor:null},page:0,pages:[{name:null,children:[{name:null,content:null}]}]}}},beforeCreate:function(){var e=this;this.$root.$on("site",function(t){e.site=t}),this.$root.$on("globals",function(t){e.globals=t})},methods:{getAllPages:function(e,t){var a=!0,i=!1,n=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var r=s.value;t.push(r),"undefined"!==typeof r.children&&this.getAllPages(r.children,t)}}catch(l){i=!0,n=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}return t},getPages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[];if(null===e){var a=!0,i=!1,n=void 0;try{for(var s,o=this.site.pages[0].children[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var r=s.value;t.push(r)}}catch(l){i=!0,n=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}}return t}},computed:{sitePage:function(){var e=this.getAllPages(this.site.pages[0].children,[]),t=this.$_.find(e,["uuid",this.globals.currentPage]);return t||null}}},k=S,P=(a("bf30"),Object(g["a"])(k,y,q,!1,null,null,null)),w=P.exports,_={name:"PageIndex",components:{ColorPicker:p,ImageUpload:m["a"],Editor:x,SiteView:w},data:function(){return{siteChangesDetected:!1,pageChangesDetected:!1,siteLoading:!0,leftColumnLoading:!0,rightColumnLoading:!0,siteTab:"pages",pageTab:"content",expandedSiteDesignBackground:!1,expandedSiteDesignHeader:!1,expandedSiteDesignTitleToolbar:!1,expandedSiteDesignSideNav:!1,expandedPageSettingsGeneral:!1,treeExpandedKeys:[-1],globals:{uuid:null,currentPage:null},oldGlobals:null,currentPage:null,nextPage:null,site:{design:{},pages:[{uuid:-1,children:[]}]},oldSite:null,undoSite:null,oldSitePages:null,undoSitePages:null,errorBag:{},pageModules:[{icon:"notes",color:"grey-9",text:"Content",description:"Basic content page.",module:"Content",canBeHomePage:!0,onlyOneInstanceAllowed:!1}]}},created:function(){var e=this;this.globals.uuid=this.$route.params.uuid||null,this.oldGlobals=this.copyObject(this.globals),this.$axios.get("site",{params:{uuid:this.globals.uuid}}).then(function(t){if(0===t.data.length)e.$router.push({name:"sites.overview"});else{e.site=t.data,e.oldSite=e.copyObject(e.site),e.undoSite=e.copyObject(e.site),e.oldSitePages=e.copyObject(e.site.pages[0].children),e.undoSitePages=e.copyObject(e.site.pages[0].children),e.globals.currentPage=e.site.pages[0].children[0].uuid||null,e.currentPage=e.site.pages[0].children[0].uuid||null,e.errorBag.name={error:!1,errorMsg:null},e.errorBag.siteName={error:!1,errorMsg:null};var a=[];for(var i in e.oldSite.design)a.includes(i)||(a.push(i),e.errorBag[i]={error:!1,errorMsg:null});for(var n in e.oldSitePages)for(var s in e.oldSitePages[n].content)a.includes(s)||(a.push(s),e.errorBag[s]={error:!1,errorMsg:null});e.$root.$emit("site",e.site),e.siteLoading=!1,e.leftColumnLoading=!1,e.rightColumnLoading=!1}})},beforeRouteLeave:function(e,t,a){this.siteChangesDetected||this.pageChangesDetected?this.$root.$confirm("Do you really want to leave? You have unsaved changes.",{icon:"exit_to_app"}).then(function(e){e&&a()}):a()},watch:{globals:{handler:function(e,t){var a=String(JSON.stringify(e)),i=String(JSON.stringify(this.oldGlobals));a!==i&&(this.$root.$emit("globals",this.globals),this.oldGlobals=this.copyObject(this.globals))},deep:!0},site:{handler:function(e,t){var a=String(JSON.stringify(e)),i=String(JSON.stringify(this.oldSite)),n=String(JSON.stringify(e.pages[0].children)),s=String(JSON.stringify(this.oldSitePages));n!==s?(this.pageChangesDetected=!0,this.$root.$emit("site",this.site),this.oldSite=this.copyObject(this.site),this.oldSitePages=this.copyObject(this.site.pages[0].children)):a!==i&&(this.siteChangesDetected=!0,this.$root.$emit("site",this.site),this.oldSite=this.copyObject(this.site),this.oldSitePages=this.copyObject(this.site.pages[0].children))},deep:!0}},methods:{saveSite:function(){var e=this;this.leftColumnLoading=!0;var t=this.copyObject(this.site);t.siteName=t.pages[0].name,t.pages[0]=null;var a=new FormData;a.append("locale",this.$i18n.locale),a.append("site",JSON.stringify(t)),a.append("site_uuid",this.globals.uuid),this.$axios.post("site/save-site",a,{headers:{"content-type":"multipart/form-data"}}).then(function(t){"undefined"!==typeof t.data.msg&&e.$q.notify({icon:"success"===t.data.status?"done":"error",position:"bottom-left",message:t.data.msg}),e.siteChangesDetected=!1}).catch(function(t){var a=t.response.data;if("undefined"!==typeof a.errors){var i=Object.keys(a.errors)[0],n="undefined"!==typeof e.$refs[i]?e.$refs[i]:null,s=null!==n?n.$parent.name:null;for(var o in e.siteTab=s,a.errors)e.errorBag[o].error=!0,e.errorBag[o].errorMsg=a.errors[o][0]}}).finally(function(){e.leftColumnLoading=!1})},undoSiteChanges:function(){var e=this;for(var t in this.site.design=this.copyObject(this.undoSite.design),this.site.pages[0])"children"!==t&&"design"!==t&&(this.site.pages[0][t]=this.undoSite.pages[0][t]);this.$nextTick(function(){e.siteChangesDetected=!1})},addPage:function(e){console.log(e)},deletePage:function(){this.$root.$confirm("Do you want to delete this page?",{icon:"delete"}).then(function(e){e&&console.log("delete")})},checkForPageChanges:function(){var e=this;null===this.nextPage&&(this.nextPage=this.globals.currentPage),this.pageChangesDetected?(this.globals.currentPage=this.currentPage,this.$root.$confirm("Do you want to continue and lose all unsaved changes you have made to this page?",{icon:"mdi-file-undo"}).then(function(t){t?(e.site.pages[0].children=e.copyObject(e.undoSitePages),e.globals.currentPage=e.nextPage,e.currentPage=e.globals.currentPage,e.nextPage=null,e.$nextTick(function(){e.pageChangesDetected=!1})):e.nextPage=null})):(this.undoSitePages=this.copyObject(this.site.pages[0].children),this.currentPage=this.globals.currentPage,this.nextPage=null)},savePage:function(){var e=this;this.rightColumnLoading=!0;var t=new FormData;t.append("locale",this.$i18n.locale),t.append("page",JSON.stringify(this.sitePage)),t.append("site_uuid",this.globals.uuid),this.$axios.post("site/save-page",t,{headers:{"content-type":"multipart/form-data"}}).then(function(t){"undefined"!==typeof t.data.msg&&e.$q.notify({icon:"success"===t.data.status?"done":"error",position:"bottom-left",message:t.data.msg}),e.pageChangesDetected=!1}).catch(function(t){var a=t.response.data;if("undefined"!==typeof a.errors){var i=Object.keys(a.errors)[0],n="undefined"!==typeof e.$refs[i]?e.$refs[i]:null,s=null!==n?n.$parent.name:null;for(var o in e.pageTab=s,a.errors)e.errorBag[o].error=!0,e.errorBag[o].errorMsg=a.errors[o][0]}}).finally(function(){e.rightColumnLoading=!1})},undoPageChanges:function(){var e=this;this.site.pages[0].children=this.copyObject(this.undoSitePages),this.$nextTick(function(){e.pageChangesDetected=!1})},copyObject:function(e){var t,a,i;for(i in t=Array.isArray(e)?[]:{},e)a=e[i],t[i]="object"===o()(a)?this.copyObject(a):a;return t},getAllPages:function(e,t){var a=!0,i=!1,n=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var r=s.value;t.push(r),"undefined"!==typeof r.children&&this.getAllPages(r.children,t)}}catch(l){i=!0,n=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw n}}return t}},computed:{sitePage:function(){var e=this.getAllPages(this.site.pages[0].children,[]),t=this.$_.find(e,["uuid",this.globals.currentPage]);return t||null}}},$=_,B=(a("425d"),Object(g["a"])($,i,n,!1,null,null,null));t["default"]=B.exports},9529:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-input",{ref:e.name+"FileName",staticClass:"q-mb-lg ellipsis",attrs:{label:e.label,readonly:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{round:"",color:"white","text-color":"grey-9",flat:"",size:"sm",icon:"mdi-image-plus"},on:{click:e.uploadFile}},[a("q-tooltip",[e._v("\n          Upload image\n        ")])],1),a("q-btn",{attrs:{round:"",disabled:null===e.filename||""===e.filename,color:"white","text-color":"grey-9",flat:"",size:"sm",icon:"delete"},on:{click:e.removeUpload}},[a("q-tooltip",[e._v("\n          Delete image\n        ")])],1)]},proxy:!0}]),model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showUploader,expression:"showUploader"}],staticClass:"row"},[a("div",{staticClass:"col"},[a("q-uploader",{ref:"uploader",staticClass:"q-mb-md",staticStyle:{width:"100%"},attrs:{name:e.name,id:e.name,label:"Upload new image",accept:".jpg, image/*",color:"grey-8",flat:"",bordered:"","hide-upload-btn":""},on:{added:e.uploadAdded,removed:e.uploadRemoved}})],1)])],1)},n=[],s=(a("7f7f"),a("28a5"),a("f559"),{name:"image-upload",model:{prop:"v-model",event:"input"},data:function(){return{pauseVModelWatch:!1,originalFilename:null,filename:null,showUploader:!1,uploadImgSrc:null,uploadImgSrcOld:null}},props:{label:{default:null,required:!1,type:String},vModel:{default:null,required:!1,type:String},name:{default:"file",required:!1,type:String},defaultValue:{default:"",required:!1,type:String},defaultToOriginal:{default:!1,required:!1,type:Boolean}},created:function(){this.uploadImgSrcOld=this.imgSrc,this.filename=null===this.vModel||""===this.vModel||this.vModel.startsWith("data:")?this.defaultValue:this.vModel.split("/").reverse()[0],this.originalFilename=JSON.parse(JSON.stringify(this.filename))},watch:{uploadImgSrc:function(e,t){this.imgSrc=e},vModel:function(e,t){this.pauseVModelWatch||(this.filename=this.originalFilename)}},methods:{uploadFile:function(){var e=this;this.$refs.uploader.removeQueuedFiles(),this.$nextTick(function(){e.$refs.uploader.pickFiles()})},removeUpload:function(){var e=this;this.pauseVModelWatch=!0,this.$refs.uploader.reset(),this.$refs.uploader.removeQueuedFiles(),this.filename=null,this.imgSrc=this.defaultToOriginal?this.uploadImgSrcOld:"",this.$nextTick(function(){e.pauseVModelWatch=!1})},uploadAdded:function(e){var t=this;this.pauseVModelWatch=!0,this.imgSrc=e[0].__img.src,this.filename=e[0].name,this.$emit("filename",this.filename),this.$nextTick(function(){t.pauseVModelWatch=!1})},uploadRemoved:function(e){this.imgSrc=this.uploadImgSrcOld,this.filename=null}},computed:{imgSrc:{get:function(){return this.vModel},set:function(e){this.uploadImgSrc=e,this.$emit("input",e)}}}}),o=s,r=(a("37c5"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,null,null);t["a"]=l.exports},ac4d:function(e,t,a){a("3a72")("asyncIterator")},bf30:function(e,t,a){"use strict";var i=a("5212"),n=a.n(i);n.a}}]);